# Single source of truth for all Day-0 inputs (copy to inputs.yaml and edit)
proxmox:
  # Terraform provider auth for Day-0 file upload/template creation
  endpoint: https://proxmox.example:8006/api2/json
  api_token: "pmx-token-id=pmx-token" # format: <user@pam>!<token-name>=<secret>
  tls_insecure: false
  # Storage/network defaults
  datastore: local-lvm
  node: pve
  bridge: vmbr0
  datacenter: pve # CAPMOX ProxmoxCluster.spec.datacenter
  # Upload settings for 00-proxmox-foundation
  upload:
    enabled: true
    content_type: iso # iso or snippets
    source_file: ./artifacts/talos-amd64.iso # path relative to terraform/_root when running
    checksum: null # optional
  # Optional VM template creation
  create_vm_template: false
  vm_template_name: talos-template
  template_cpu_cores: 2
  template_cpu_sockets: 1
  template_memory_mib: 2048
  template_disk_gib: 20

# Talos settings reused for mgmt configs
talos:
  image: ghcr.io/siderolabs/installer:v1.7.4
  token: CHANGEME-TALOS-MACHINE-TOKEN

mgmt:
  cluster_name: mgmt
  control_plane_endpoints:
    - 10.0.0.10
    - 10.0.0.11
  worker_endpoints: []

capi_operator:
  helm:
    enabled: true
    repository: https://kubernetes-sigs.github.io/cluster-api-operator
    chart: cluster-api-operator
    version: 0.9.2
    namespace: capi-operator-system
  providers:
    capmox:
      version: v0.7.0 # example, pin as needed
    talos:
      version: v0.5.5 # example for bootstrap/controlplane providers

capmox:
  # Credentials Secret; used by 30-capmox template
  credentials:
    api_url: https://proxmox.example:8006/api2/json
    username: user@pam
    token_id: my-token
    token_secret: my-secret

addons:
  cilium_install_method: helm
  cilium_version: 1.18.2

# Example workload cluster spec for 40-clusters
cluster:
  name: demo
  control_plane_endpoint:
    host: 10.0.1.10
    port: 6443
  pod_cidrs: 10.244.0.0/16
  service_cidrs: 10.96.0.0/12
  kubernetes_version: v1.30.4
  talos_version: v1.7.4
  control_plane:
    replicas: 3
    cpu: 4
    memoryMiB: 8192
    diskGiB: 50

# Staged apply flags and kubeconfig path for phase-2
flags:
  enable_capi: true
  enable_capmox: true
  enable_clusters: true
  enable_addons: true

kubernetes:
  kubeconfig: ./artifacts/mgmt-kubeconfig # set after mgmt bootstrap
  workers:
    replicas: 3
    cpu: 4
    memoryMiB: 8192
    diskGiB: 50
