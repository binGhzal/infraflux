# Production Environment Configuration

# Environment-specific overrides for production
environment:
  name: "prod"
  domain: "platform.company.com"

# Cluster configuration overrides
clusterOverrides:
  # Production-sized cluster
  nodes:
    controlPlane:
      count: 3
      cpu: 8
      memory: "16Gi"
      disk: "200Gi"
    worker:
      count: 5
      cpu: 16
      memory: "32Gi"
      disk: "500Gi"

# Infrastructure component overrides
infrastructureOverrides:
  # Use production certificates
  certManager:
    config:
      defaultIssuer: "letsencrypt-prod"
      acme:
        server: "https://acme-v02.api.letsencrypt.org/directory"
  
  # Extended monitoring retention
  monitoring:
    prometheus:
      retention: "90d"
      storage: "200Gi"
  
  # Production Cilium configuration
  cilium:
    config:
      encryption: true  # Enable encryption in production
      hubble:
        enabled: true
        ui: true

# Production-specific features
featureOverrides:
  # Disable experimental features
  chaosEngineering: false
  imageScanning: true
  costMonitoring: true

# Strict security for production
securityOverrides:
  podSecurity:
    enforce: "restricted"
    audit: "restricted"
    warn: "restricted"

# Larger resource quotas for production
resourceOverrides:
  defaultQuota:
    requests:
      cpu: "16"
      memory: "32Gi"
      storage: "200Gi"
    limits:
      cpu: "32"
      memory: "64Gi"

# Production-specific backup configuration
backupOverrides:
  enabled: true
  etcd:
    schedule: "0 1,13 * * *"  # Twice daily
    retention: "90"  # Keep 90 backups
  velero:
    enabled: true
# High-availability multi-node cluster for production workloads

cluster:
  name: "infraflux-prod"
  controlplane_count: 3
  worker_count: 3
  allow_scheduling_on_controlplane: false

proxmox:
  api_url: "https://proxmox.local:8006/api2/json"
  user: "terraform@pve"
  target_node: "pve"
  storage: "local-lvm"
  tls_insecure: true

talos:
  template_id: 9000
  version: "v1.6.0"

network:
  bridge: "vmbr0"
  vlan_tag: 100 # Production VLAN
  subnet: "10.0.100.0/24"
  base_ip: "10.0.100."
  ip_start: 10
  gateway: "10.0.100.1"
  dns_servers:
    - "10.0.1.1"
    - "10.0.1.2"
  cluster_vip: "10.0.100.100" # Virtual IP for HA

nodes:
  controlplane:
    cpu_cores: 4
    memory_mb: 8192
    disk_size_gb: 100
  worker:
    cpu_cores: 8
    memory_mb: 16384
    disk_size_gb: 200

features:
  cilium:
    enabled: true
    cluster_mesh: true
    hubble: true
    tetragon: true
    bgp: true
    encryption: "wireguard"

  monitoring:
    enabled: true
    prometheus: true
    grafana: true
    alertmanager: true
    loki: true

  cert_manager:
    enabled: true
    cluster_issuer: "letsencrypt-prod"

  argocd:
    enabled: true
    repo_url: "https://github.com/binGhzal/PlatformNorthStar"
    ha: true

  backup:
    enabled: true
    schedule: "0 2 * * *"
    retention: "30d"

security:
  pod_security_standards: "restricted"
  network_policies: true
  encryption_at_rest: true
  image_scanning: true
  compliance_scanning: true

storage:
  longhorn:
    enabled: true
    replicas: 3
    backup_target: "nfs://backup.local/longhorn"
