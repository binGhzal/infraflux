# External Secrets Operator (ESO) â€” 1Password SDK

This installs ESO via Helm and wires a SecretStore for 1Password SDK. Secrets remain in 1Password; Kubernetes gets ephemeral Secrets generated by ESO.

Key pieces:

- Helm install via Terraform module `modules/external-secrets` into `external-secrets` namespace with CRDs.
- SecretStore `onepassword` (see `old/gitops/apps/externalsecrets/secretstore-1password-sdk.yaml`). Provide a service token via a Kubernetes Secret created out-of-band.
- ExternalSecret examples for Cloudflare, Argo CD OIDC, etc.

Mermaid overview:

```mermaid
flowchart LR
  subgraph ArgoCD
    Root[Root Application]
    AS[ApplicationSet]
  end
  subgraph Cluster
    ES[External Secrets Operator]
    SS[SecretStore: 1Password SDK]
    EXS[ExternalSecret: CF Token / OIDC]
    KS[(Kubernetes Secret)]
  end
  OP[1Password Vault]

  Root --> AS
  AS -->|sync manifests| SS
  AS --> EXS
  ES --> SS
  EXS -->|reads via| SS
  EXS -->|materializes| KS
  SS <-->|SDK| OP
```

Notes:

- Do not commit real tokens. Use CI or manual `kubectl create secret` to populate the service token.
- Prefer narrowly scoped vault access for least privilege.
